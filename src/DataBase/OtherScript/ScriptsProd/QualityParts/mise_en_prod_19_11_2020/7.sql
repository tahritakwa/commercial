/*
Ce script a été créé par Visual Studio dans 16/10/2020 à 14:58.
Exécutez ce script sur ..QualityParts (dev) pour le rendre identique à ..MasterGuidTN (dev).
Ce script effectue ses actions dans l'ordre suivant :
1. Désactive les contraintes de clé étrangère.
2. Effectue des commandes DELETE. 
3. Effectue des commandes UPDATE.
4. Effectue des commandes INSERT.
5. Réactive les contraintes de clé étrangère.
Sauvegardez votre base de données cible avant d'exécuter ce script.
*/
SET NUMERIC_ROUNDABORT OFF
GO
SET XACT_ABORT, ANSI_PADDING, ANSI_WARNINGS, CONCAT_NULL_YIELDS_NULL, ARITHABORT, QUOTED_IDENTIFIER, ANSI_NULLS ON
GO
/*Pointeur utilisé pour les mises à jour de texte ou d'image. Cela n'est peut-être pas nécessaire, mais est déclaré ici le cas échéant*/
DECLARE @pv binary(16)
BEGIN TRANSACTION
ALTER TABLE [Payroll].[VariableValidityPeriod] DROP CONSTRAINT [FK_VariableValidityPeriod_Variable]
ALTER TABLE [Payroll].[Variable] DROP CONSTRAINT [FK_Variable_RuleUnique]
ALTER TABLE [Payroll].[SalaryRuleValidityPeriod] DROP CONSTRAINT [FK_SalaryRuleValidityPeriod_SalaryRule]
ALTER TABLE [Sales].[DocumentType] DROP CONSTRAINT [FK_DocumentType_DocumentType]
ALTER TABLE [Payroll].[SalaryStructure] DROP CONSTRAINT [FK_SalaryStructure_SalaryStructureParent]
ALTER TABLE [Payroll].[SalaryStructureValidityPeriodSalaryRule] DROP CONSTRAINT [FK_SalaryStructureValidityPeriodSalaryRule_SalaryStructureValidityPeriod]
ALTER TABLE [Payroll].[SalaryStructureValidityPeriodSalaryRule] DROP CONSTRAINT [FK_SalaryStructureValidityPeriodSalaryRule_SalaryRule]
ALTER TABLE [Payroll].[SalaryStructureValidityPeriod] DROP CONSTRAINT [FK_SalaryStructureValidityPeriod_SalaryStructure]
UPDATE [Sales].[DocumentType] SET [LabelEn]=N'Asset' WHERE [CodeType]=N'A-PU'
UPDATE [Sales].[DocumentType] SET [LabelEn]=N'Asset' WHERE [CodeType]=N'A-SA'
UPDATE [Sales].[DocumentType] SET [LabelEn]=N'Admission vouchers' WHERE [CodeType]=N'BE-PU'
UPDATE [Sales].[DocumentType] SET [LabelEn]=N'Quotation' WHERE [CodeType]=N'B-PU'
UPDATE [Sales].[DocumentType] SET [LabelEn]=N'Exit vouchers' WHERE [CodeType]=N'BS-SA'
UPDATE [Sales].[DocumentType] SET [LabelEn]=N'Receipt' WHERE [CodeType]=N'D-PU'
UPDATE [Sales].[DocumentType] SET [LabelEn]=N'Delivery form' WHERE [CodeType]=N'D-SA'
UPDATE [Sales].[DocumentType] SET [LabelEn]=N'Client invoice asset' WHERE [CodeType]=N'IA-SA'
UPDATE [Sales].[DocumentType] SET [LabelEn]=N'Price requests' WHERE [CodeType]=N'Q-PU'
UPDATE [Sales].[DocumentType] SET [LabelEn]=N'Quotation' WHERE [CodeType]=N'Q-SA'
UPDATE [Sales].[DocumentType] SET [LabelEn]=N'Purchase requests' WHERE [CodeType]=N'RQ-PU'
UPDATE [Payroll].[SalaryStructure] SET [TransactionUserId]=0 WHERE [Id]=4
UPDATE [Payroll].[ContractType] SET [Description]=N'Contract à durée déterminée', [TransactionUserId]=1, [Code]=N'CDD', [MinNoticePeriod]=1, [MaxNoticePeriod]=5, [Label]=N'CDD' WHERE [Id]=1
GO
SET IDENTITY_INSERT [Payroll].[RuleUniqueReference] ON
INSERT INTO [Payroll].[RuleUniqueReference] ([Id], [Reference], [Type], [IsDeleted], [TransactionUserId], [DeletedToken]) VALUES (99, N'SMIG', 2, 0, 0, NULL)
SET IDENTITY_INSERT [Payroll].[RuleUniqueReference] OFF
GO
SET IDENTITY_INSERT [Payroll].[SalaryStructureValidityPeriod] ON
INSERT INTO [Payroll].[SalaryStructureValidityPeriod] ([Id], [StartDate], [IdSalaryStructure], [IsDeleted], [Deleted_Token], [TransactionUserId]) VALUES (29, '20180101', 10, 0, NULL, 0)
INSERT INTO [Payroll].[SalaryStructureValidityPeriod] ([Id], [StartDate], [IdSalaryStructure], [IsDeleted], [Deleted_Token], [TransactionUserId]) VALUES (30, '20180101', 9, 0, NULL, 0)
INSERT INTO [Payroll].[SalaryStructureValidityPeriod] ([Id], [StartDate], [IdSalaryStructure], [IsDeleted], [Deleted_Token], [TransactionUserId]) VALUES (31, '20180101', 8, 0, NULL, 0)
INSERT INTO [Payroll].[SalaryStructureValidityPeriod] ([Id], [StartDate], [IdSalaryStructure], [IsDeleted], [Deleted_Token], [TransactionUserId]) VALUES (32, '20180101', 7, 0, NULL, 0)
INSERT INTO [Payroll].[SalaryStructureValidityPeriod] ([Id], [StartDate], [IdSalaryStructure], [IsDeleted], [Deleted_Token], [TransactionUserId]) VALUES (33, '20180101', 5, 0, NULL, 0)
INSERT INTO [Payroll].[SalaryStructureValidityPeriod] ([Id], [StartDate], [IdSalaryStructure], [IsDeleted], [Deleted_Token], [TransactionUserId]) VALUES (34, '20180101', 4, 0, NULL, 0)
SET IDENTITY_INSERT [Payroll].[SalaryStructureValidityPeriod] OFF
GO
SET IDENTITY_INSERT [Payroll].[SalaryStructureValidityPeriodSalaryRule] ON
INSERT INTO [Payroll].[SalaryStructureValidityPeriodSalaryRule] ([Id], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdSalaryRule], [IdSalaryStructureValidityPeriod]) VALUES (165, 0, 0, NULL, 74, 29)
INSERT INTO [Payroll].[SalaryStructureValidityPeriodSalaryRule] ([Id], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdSalaryRule], [IdSalaryStructureValidityPeriod]) VALUES (166, 0, 0, NULL, 75, 29)
INSERT INTO [Payroll].[SalaryStructureValidityPeriodSalaryRule] ([Id], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdSalaryRule], [IdSalaryStructureValidityPeriod]) VALUES (167, 0, 0, NULL, 77, 29)
INSERT INTO [Payroll].[SalaryStructureValidityPeriodSalaryRule] ([Id], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdSalaryRule], [IdSalaryStructureValidityPeriod]) VALUES (168, 0, 0, NULL, 78, 30)
INSERT INTO [Payroll].[SalaryStructureValidityPeriodSalaryRule] ([Id], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdSalaryRule], [IdSalaryStructureValidityPeriod]) VALUES (169, 0, 0, NULL, 89, 30)
INSERT INTO [Payroll].[SalaryStructureValidityPeriodSalaryRule] ([Id], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdSalaryRule], [IdSalaryStructureValidityPeriod]) VALUES (170, 0, 0, NULL, 90, 30)
INSERT INTO [Payroll].[SalaryStructureValidityPeriodSalaryRule] ([Id], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdSalaryRule], [IdSalaryStructureValidityPeriod]) VALUES (171, 0, 0, NULL, 74, 34)
INSERT INTO [Payroll].[SalaryStructureValidityPeriodSalaryRule] ([Id], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdSalaryRule], [IdSalaryStructureValidityPeriod]) VALUES (172, 0, 0, NULL, 75, 34)
INSERT INTO [Payroll].[SalaryStructureValidityPeriodSalaryRule] ([Id], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdSalaryRule], [IdSalaryStructureValidityPeriod]) VALUES (173, 0, 0, NULL, 76, 34)
INSERT INTO [Payroll].[SalaryStructureValidityPeriodSalaryRule] ([Id], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdSalaryRule], [IdSalaryStructureValidityPeriod]) VALUES (174, 0, 0, NULL, 77, 34)
INSERT INTO [Payroll].[SalaryStructureValidityPeriodSalaryRule] ([Id], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdSalaryRule], [IdSalaryStructureValidityPeriod]) VALUES (175, 0, 0, NULL, 78, 33)
INSERT INTO [Payroll].[SalaryStructureValidityPeriodSalaryRule] ([Id], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdSalaryRule], [IdSalaryStructureValidityPeriod]) VALUES (176, 0, 0, NULL, 89, 33)
INSERT INTO [Payroll].[SalaryStructureValidityPeriodSalaryRule] ([Id], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdSalaryRule], [IdSalaryStructureValidityPeriod]) VALUES (177, 0, 0, NULL, 90, 33)
SET IDENTITY_INSERT [Payroll].[SalaryStructureValidityPeriodSalaryRule] OFF
GO
SET IDENTITY_INSERT [Payroll].[SalaryRuleValidityPeriod] ON
INSERT INTO [Payroll].[SalaryRuleValidityPeriod] ([Id], [StartDate], [rule], [IdSalaryRule], [IsDeleted], [Deleted_Token], [TransactionUserId]) VALUES (1158, '20180101', NULL, 74, 0, NULL, 0)
INSERT INTO [Payroll].[SalaryRuleValidityPeriod] ([Id], [StartDate], [rule], [IdSalaryRule], [IsDeleted], [Deleted_Token], [TransactionUserId]) VALUES (1159, '20180101', NULL, 75, 0, NULL, 0)
INSERT INTO [Payroll].[SalaryRuleValidityPeriod] ([Id], [StartDate], [rule], [IdSalaryRule], [IsDeleted], [Deleted_Token], [TransactionUserId]) VALUES (1160, '20180101', NULL, 76, 0, NULL, 0)
INSERT INTO [Payroll].[SalaryRuleValidityPeriod] ([Id], [StartDate], [rule], [IdSalaryRule], [IsDeleted], [Deleted_Token], [TransactionUserId]) VALUES (1161, '20180101', NULL, 77, 0, NULL, 0)
INSERT INTO [Payroll].[SalaryRuleValidityPeriod] ([Id], [StartDate], [rule], [IdSalaryRule], [IsDeleted], [Deleted_Token], [TransactionUserId]) VALUES (1189, '20180101', N'Si (NETANNUEL > SMIG)
Alors NETANNUEL/12*0.01
Sinon 0
finsi                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ', 90, 0, NULL, 0)
INSERT INTO [Payroll].[SalaryRuleValidityPeriod] ([Id], [StartDate], [rule], [IdSalaryRule], [IsDeleted], [Deleted_Token], [TransactionUserId]) VALUES (1190, '20180101', N'si(Employee.IsForeign)
    Alors (NETANNUEL *30/100/12)
    sinon
        si (NETANNUEL> 50000)
            Alors ((NETANNUEL-50000)*35/100 + 50000*26,20/100)/12
        sinon
          si (NETANNUEL> 30000)
                  Alors ((NETANNUEL-30000)*32/100 + 6700)/12
            sinon
                    si (NETANNUEL> 20000)
                             Alors ((NETANNUEL-20000)*28/100 + 20000*19,5/100)/12
                     sinon
                               si (NETANNUEL> 5000) Alors ((NETANNUEL-5000)*26/100)/12
                               sinon 0
                                finsi
                     finsi
            finsi
        finsi
    finsi                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ', 89, 0, NULL, 0)
INSERT INTO [Payroll].[SalaryRuleValidityPeriod] ([Id], [StartDate], [rule], [IdSalaryRule], [IsDeleted], [Deleted_Token], [TransactionUserId]) VALUES (1191, '20180101', N'BASE * Cnss.SalaryRate/100 + PRIME_COTISABLE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ', 78, 0, NULL, 0)
SET IDENTITY_INSERT [Payroll].[SalaryRuleValidityPeriod] OFF
GO
SET IDENTITY_INSERT [Payroll].[Variable] ON
INSERT INTO [Payroll].[Variable] ([Id], [Description], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdRuleUniqueReference], [Name]) VALUES (33, N'Salaire minimum interprofessionnel garanti', 0, 0, NULL, 99, N'SMIG')
SET IDENTITY_INSERT [Payroll].[Variable] OFF
GO
SET IDENTITY_INSERT [Payroll].[VariableValidityPeriod] ON
INSERT INTO [Payroll].[VariableValidityPeriod] ([Id], [StartDate], [Formule], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdVariable]) VALUES (21, '20180101', N'BASEIMPOSABLEANNUEL- NEnfant - NChefFamille-CreditHabitation-NBEnfantNonBoursier-NBEnfantHandicape-PARENTACHARGE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ', 0, NULL, N'0', 9)
INSERT INTO [Payroll].[VariableValidityPeriod] ([Id], [StartDate], [Formule], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdVariable]) VALUES (22, '20180101', N'Si (Employee.FamilyLeader)
    Alors Employee.ChildrenNumber * 100
Sinon 0
Finsi                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ', 0, NULL, N'0', 12)
INSERT INTO [Payroll].[VariableValidityPeriod] ([Id], [StartDate], [Formule], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdVariable]) VALUES (23, '20180101', N'Si (BRUTIMPOSABLEANNUEL > FRAISREELS)
	Alors BRUTIMPOSABLEANNUEL - FRAISREELS
Sinon 0
Finsi', 0, NULL, N'0', 13)
INSERT INTO [Payroll].[VariableValidityPeriod] ([Id], [StartDate], [Formule], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdVariable]) VALUES (24, '20180101', N'Si (BRUTIMPOSABLEANNUEL > 20000)
    Alors 2000
Sinon BRUTIMPOSABLEANNUEL/10
Finsi                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ', 0, NULL, N'0', 14)
INSERT INTO [Payroll].[VariableValidityPeriod] ([Id], [StartDate], [Formule], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdVariable]) VALUES (25, '20180101', N'Si (Employee.FamilyLeader)
    Alors 500
Sinon 0
Finsi                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ', 0, NULL, N'0', 16)
INSERT INTO [Payroll].[VariableValidityPeriod] ([Id], [StartDate], [Formule], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdVariable]) VALUES (26, '20180101', N'Employee.HomeLoan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ', 0, NULL, N'0', 21)
INSERT INTO [Payroll].[VariableValidityPeriod] ([Id], [StartDate], [Formule], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdVariable]) VALUES (27, '20180101', N'Employee.ChildrenNoScholar*1000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ', 0, NULL, N'0', 22)
INSERT INTO [Payroll].[VariableValidityPeriod] ([Id], [StartDate], [Formule], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdVariable]) VALUES (28, '20180101', N'Employee.ChildrenDisabled*2000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ', 0, NULL, N'0', 23)
INSERT INTO [Payroll].[VariableValidityPeriod] ([Id], [StartDate], [Formule], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdVariable]) VALUES (29, '20180101', N'(BASE + PRIME_IMPOSABLE - CNSS)*12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ', 0, NULL, N'0', 29)
INSERT INTO [Payroll].[VariableValidityPeriod] ([Id], [StartDate], [Formule], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdVariable]) VALUES (30, '20180101', N'BASEIMPOSABLEANNUEL * 5 / 100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ', 0, NULL, N'0', 31)
INSERT INTO [Payroll].[VariableValidityPeriod] ([Id], [StartDate], [Formule], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdVariable]) VALUES (31, '20180101', N'Si (BASECALCULPARENTACHARGE > 150)
    Alors Employee.DependentParent * 150
Sinon BASECALCULPARENTACHARGE * Employee.DependentParent
Finsi                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ', 0, NULL, N'0', 32)
INSERT INTO [Payroll].[VariableValidityPeriod] ([Id], [StartDate], [Formule], [IsDeleted], [TransactionUserId], [Deleted_Token], [IdVariable]) VALUES (32, '20180101', N'5000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ', 0, 0, NULL, 33)
SET IDENTITY_INSERT [Payroll].[VariableValidityPeriod] OFF
ALTER TABLE [Payroll].[VariableValidityPeriod]
    WITH NOCHECK ADD CONSTRAINT [FK_VariableValidityPeriod_Variable] FOREIGN KEY ([IdVariable]) REFERENCES [Payroll].[Variable] ([Id]) ON DELETE CASCADE ON UPDATE CASCADE
ALTER TABLE [Payroll].[Variable]
    ADD CONSTRAINT [FK_Variable_RuleUnique] FOREIGN KEY ([IdRuleUniqueReference]) REFERENCES [Payroll].[RuleUniqueReference] ([Id])
ALTER TABLE [Payroll].[SalaryRuleValidityPeriod]
    WITH NOCHECK ADD CONSTRAINT [FK_SalaryRuleValidityPeriod_SalaryRule] FOREIGN KEY ([IdSalaryRule]) REFERENCES [Payroll].[SalaryRule] ([Id])
ALTER TABLE [Sales].[DocumentType]
    ADD CONSTRAINT [FK_DocumentType_DocumentType] FOREIGN KEY ([DefaultCodeDocumentTypeAssociated]) REFERENCES [Sales].[DocumentType] ([CodeType])
ALTER TABLE [Payroll].[SalaryStructure]
    ADD CONSTRAINT [FK_SalaryStructure_SalaryStructureParent] FOREIGN KEY ([IdParent]) REFERENCES [Payroll].[SalaryStructure] ([Id])
ALTER TABLE [Payroll].[SalaryStructureValidityPeriodSalaryRule]
    WITH NOCHECK ADD CONSTRAINT [FK_SalaryStructureValidityPeriodSalaryRule_SalaryStructureValidityPeriod] FOREIGN KEY ([IdSalaryStructureValidityPeriod]) REFERENCES [Payroll].[SalaryStructureValidityPeriod] ([Id]) ON DELETE CASCADE ON UPDATE CASCADE
ALTER TABLE [Payroll].[SalaryStructureValidityPeriodSalaryRule]
    ADD CONSTRAINT [FK_SalaryStructureValidityPeriodSalaryRule_SalaryRule] FOREIGN KEY ([IdSalaryRule]) REFERENCES [Payroll].[SalaryRule] ([Id])
ALTER TABLE [Payroll].[SalaryStructureValidityPeriod]
    WITH NOCHECK ADD CONSTRAINT [FK_SalaryStructureValidityPeriod_SalaryStructure] FOREIGN KEY ([IdSalaryStructure]) REFERENCES [Payroll].[SalaryStructure] ([Id]) ON DELETE CASCADE ON UPDATE CASCADE
COMMIT TRANSACTION

